var songList,$=window.Zepto,root=window.player,$scope=$(document.body),index=0,audio=new root.audioControl;function bindEvent(){$scope.on("play:change",function(o,t){audio.getAudio(songList[t].audio),root.processor.renderAllTime(songList[t].duration),"play"==audio.status&&(audio.play(),root.processor.start())}),$scope.on("click",".prev-btn",function(){index=controlManger.prev(),root.render(songList[index]),$scope.trigger("play:change",index),root.processor.start(),"play"==audio.status?root.processor.start(0):root.processor.updata(0)}),$scope.on("click",".next-btn",function(){index=controlManger.next(),root.render(songList[index]),$scope.trigger("play:change",index),root.processor.start(),"play"==audio.status?root.processor.start(0):root.processor.updata(0)}),$scope.on("click",".play-btn",function(){"play"==audio.status?(audio.pause(),root.processor.stop()):(audio.play(),root.processor.start()),$(this).toggleClass("playing")})}function touchEvent(){var r,o=$(".pro-bottom").offset(),s=o.left,e=o.width;$(".slider-point").on("touchstart",function(o){audio.pause(),audio.status="pause",root.processor.stop(),$(".play-btn").toggleClass("playing")}).on("touchmove",function(o){var t=o.changedTouches[0].clientX;0<=(r=(t-s)/e)&&r<=1&&root.processor.updata(r)}).on("touchend",function(o){var t=o.changedTouches[0].clientX;if(0<=(r=(t-s)/e)&&r<=1){var n=r*songList[index].duration;audio.playTo(n),$scope.find(".play-btn").addClass("playing"),audio.status="play",root.processor.start(r)}})}function getDate(o){$.ajax({type:"GET",url:o,success:function(o){songList=o,root.render(o[0]),bindEvent(),touchEvent(),controlManger=new root.controlManger(o.length),$scope.trigger("play:change",0)},error:function(){}})}getDate("../mock/data.json");